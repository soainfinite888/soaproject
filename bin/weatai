#!/usr/bin/env ruby
# frozen_string_literal: true
$LOAD_PATH.unshift File.join(File.dirname(__FILE__), *%w(.. lib))
require 'weatai'

dataid = ARGV[0] || ENV['DATA_ID']
unless dataid
  puts 'USAGE: weatai [dataid]'
  exit(1)
end

key = ENV['AUTH_KEY']
unless key
  puts 'USAGE: weatai [key]'
  exit(1)
end

weather = CWB::Weather.find(dataid: dataid)
raw_data = weather.instant_weather
puts raw_data
File.write('../spec/fixtures/data.yml', raw_data.to_yaml)
